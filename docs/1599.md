# HTTP 内容协商

> 原文:[https://www.javatpoint.com/http-content-negotiation](https://www.javatpoint.com/http-content-negotiation)

HTTP 的大多数响应都包含一个实体，该实体包含供用户解释的信息。自然，它用于向用户提供对应于请求的最佳可用实体。不幸的是，对于缓存和服务器来说，并不是所有用户对什么是最好的都有相同的偏好。这就是为什么 HTTP 为“**内容协商**”提供了几种机制。当有多个表示可用时，为给定响应选择最佳表示的过程。

任何包含实体主体的响应都可以进行协商，包括错误响应。

在 HTTP 中，有两种类型的内容协商，服务器驱动的协商和代理驱动的协商。两个协商是正交的，因此可以组合使用或单独使用。一种称为透明协商的组合方法发生在源服务器提供代理驱动协商的信息时，缓存使用该信息为后续请求提供服务器驱动协商。

## 服务器驱动的协商

当服务器驱动的协商发生时，则由位于服务器的算法来选择响应的最佳表示。基于资源的可用表示，选择是基于的，内容也是基于的。选择还基于请求消息中特定报头字段的内容或其他信息，这些信息是对请求的伪装(如客户端的网络地址)。

### 优势

1.  当从可用表示中进行选择的算法难以向用户代理描述时，这是有用的。
2.  当服务器希望将它的“最佳猜测”与第一个响应一起发送给客户端时，它非常有用。
3.  为了改进对服务器的猜测，用户代理可以包括描述其对这种响应的偏好的请求头部字段。

### 不足之处

1.  对于服务器来说，不可能准确地确定什么对任何给定的用户来说是最好的。这就是为什么服务器需要全面了解用户代理的功能和响应的预期用途。
2.  它使原始服务器实现和生成请求响应的算法变得复杂。

## 代理驱动的协商

当代理驱动的协商发生时，用户代理在从源服务器接收到初始响应后，执行响应的最佳表示的选择。在代理驱动的协商中，选择基于响应的可用表示的列表，该列表包含在初始响应的报头字段或实体主体中，每个表示由其自己的 URI 标识。从表示列表中的选择可以由用户从生成的菜单中手动或自动执行。

### 优势

1.  当原始服务器无法通过检查请求来确定用户代理的能力时，当响应在常用维度上有所变化时，就会使用它。
2.  当公共缓存分配服务器负载并减少网络使用时，使用它。

### 不足之处

当代理驱动的协商需要第二个请求来获得最佳替代表示时，它会受到影响。

## 透明谈判

它是服务器驱动的协商和代理驱动的协商的组合。如果以响应的可用表示列表的形式提供缓存，并且缓存完全理解了方差的维度，则缓存能够代表源服务器执行服务器驱动的协商。

* * *